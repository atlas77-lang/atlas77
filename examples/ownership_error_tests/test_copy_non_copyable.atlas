// ============================================================================
// ERROR TEST: Copy non-copyable type
// ============================================================================
// This should produce a compile-time error: trying to copy a non-copyable type

import "std/io";

// Non-copyable struct (no _copy method)
struct NonCopyable {
public:
    value: int64;

    NonCopyable() {
        this.value = 42;
        println("NonCopyable created");
    }

    ~NonCopyable() {
        println("NonCopyable destroyed");
    }

    fun get_value(&const this) -> int64 {
        return *this.value;
    }
}

fun main() {
    let obj = new NonCopyable();
    
    // First use - OK
    println(obj.get_value());
    
    // Second use - ERROR: NonCopyable doesn't have _copy method
    // but we're trying to use it multiple times which would require copy
    let obj2 = obj;  // <-- First ownership-consuming use (moves obj)
    
    // This will trigger use-after-move
    let obj3 = obj;  // <-- Expected error: trying to access moved value
    
    println(obj2.get_value());
    println(obj3.get_value());
}
